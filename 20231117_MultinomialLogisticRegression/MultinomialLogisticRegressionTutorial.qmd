---
title: "Multinomial Regression Tutorial"
author: "Barbara Flores"
format:
  pdf:
    toc: true
    number-sections: true
    number-depth: 3
output: 
  pdf_document: 
    latex_engine: xelatex
    keep_tex: true
    latex_args: ["-shell-escape"]
fontsize: 11pt
header-includes:
  - "\\usepackage[left=0.75in,right=0.75in,top=0.75in,bottom=1.25in]{geometry}"
  - "\\usepackage{enumitem}"
  - "\\setlist{noitemsep, topsep=0pt, parsep=2pt, partopsep=0pt}"
  - "\\setlength{\\parskip}{0pt}"
  - "\\RedeclareSectionCommand[beforeskip=-1sp,afterskip=0.5\\baselineskip]{section}"
  - "\\RedeclareSectionCommand[beforeskip=-1sp,afterskip=0.25\\baselineskip]{subsection}"

editor: 
  markdown: 
    wrap: 72
---

\setcounter{page}{0}

\thispagestyle{empty}

{{< pagebreak >}}

```{r, include = FALSE}
# Global settings to hide code and results in the final document
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, results= 'hide')
```

```{r}
library(pacman)
p_load(openintro, tidyverse,dplyr,tidyr, caret, pROC, e1071, sjPlot)
```

```{r}
path = "https://raw.githubusercontent.com/BarbaraPFloresRios/IDS702_ModelingAndRepresentationOfData/main/20231117_MultinomialLogisticRegression/MultinomialData.csv"

MultinomialData <-  read_csv(path)
glimpse(MultinomialData)

```

# Overview

## Generalized Linear Model

\vspace{0.3cm}

Generalized Linear Models (GLMs) are a class of statistical models in
which the relationship between a dependent variable and one or more
independent variables follows a specific probability distribution, such
as the Normal, Binomial, Poisson, Gamma, and Multinomial distributions.
The general formula of a Generalized Linear Model (GLM) is expressed as
follows:

$$
g(μ) = Xβ
$$

where

-   $g(μ)$: The link function connecting the mean $μ$ of the response
    variable distribution with the linear combination of predictor
    variables $Xβ$

-   $X$: The design matrix containing the values of the predictor
    variables.

-   $β$: The vector of coefficients associated with each predictor
    variable.

\vspace{0.3cm}

The main purpose of GLMs is to provide a statistical framework for
modeling the relationship between a dependent variable and one or more
independent variables, allowing flexibility in the distribution of the
dependent variable. The choice of probability distribution and the link
function allows the adaptation of the model to different types of data
and relationships between variables.

### Link Function

The purpose of a link function in GLMs is to connect the distribution of
the outcome variable to the linear predictors, defining the relationship
between the linear predictor and the expected value (mean) of the
response variable. It indicates how the expected value of the response
variable relates to the linear combination of explanatory variables. In
logistic regression, for example, the link function is the logit
function, which transforms the probability of the outcome variable into
a log-odds format. This allows us to model a binary response variable
using a linear combination of predictors. Within a GLM, the link
function transforms the linear combination of predictor variables into a
format that is appropriate for modeling the mean of the response
variable. This conversion is crucial, ensuring that the forecasted
values conform to the particular range determined by the characteristics
of the response distribution.

### GLM Assumptions

GLMs consider the following assumptions:

-   The data are independently distributed.

-   The dependent variable Y follows a specific distribution.

-   There is a linear relationship between the transformed expected
    response, in terms of the link function, and the explanatory
    variables.

\vspace{0.3cm}

In particular, in this tutorial, we will address a type of GLM,
Multinomial Logistic Regression, which is detailed in the following
sections

\vspace{0.3cm}

## Multinomial Regression

Multinomial regression is a form of GLM employed when the outcome
variable encompasses multiple categories. In this regression, the
multinomial distribution is utilized to model the outcome variable.

### Examples of research questions 

Some examples of research questions that could be answered with
Multinomial regression are:

-   **Inference problem:** Within the context of a university student
    having the choice to enroll in a major among the academic
    departments of 'Social Sciences and Humanities,' 'Health Sciences,'
    'Natural Sciences and Mathematics,' and 'Arts,' what
    sociodemographic variables significantly influence the selection of
    academic departments?

    \vspace{0.3cm}

-   **Prediction problem:** Based on a new customer's viewing history on
    a movie streaming service, which includes variables such as the
    number and type of movies watched, total duration in minutes, etc.,
    what option is the customer most likely to choose at the conclusion
    of the 30-day trial period: cancel their subscription, subscribe to
    the monthly plan, or subscribe to the annual plan?

    \vspace{0.3cm}

# Probability Distribution: Multinomial

The multinomial distribution models the probability of observing a
specific vector of event counts across $k$ different categories, after
conducting $n$ independent trials. The Probability Mass Function (PMF)
describes the joint probability of observing $x_1$ events in category 1,
$x_2$ events in category 2, and so forth. The PMF is expressed by the
following formula:

\vspace{0.3cm}

**Probability Mass Function**

$$Pr(X_1 = x_1, ... , X_k = x_k) = \frac{n!}{x_1!...x_k!}p_1^{x_1}...p_k^{x_k}$$

Now, let's delve into the support of the multinomial distribution, which
outlines the valid range of counts for each category, providing insights
into the possible outcomes of the experiment:

\vspace{0.3cm}

**Support** $$
x_i\,\epsilon\{0,..,n\},  i\,\epsilon\{1,..,k\}, with\: \sum\limits_i x_i=n
$$

Each $x_i$represents the count of occurrences for event $i$, and it can
range from 0 to the total number of trials $n$. The constraint
$\sum\limits_i x_i=n$ ensures that the total count of occurrences across
all categories equals the total number of trials, emphasizing the nature
of the distribution.

The parameters of this probability distribution model, adhere to the
following constraints:

\vspace{0.3cm}

**Parameters**

\centering

$n > 0$ number of trials, $k > 0$ number of mutually exclusive events,

$p_1,....p_k$ event probabilities ($\: \sum\limits_i p_i=1$)

\raggedright

sdds

sdsd

\vspace{0.3cm}

# The Model

# Data Example

# 
