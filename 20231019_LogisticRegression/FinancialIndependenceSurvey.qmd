---
title: "Financial Independence Survey - Logistic Regression Model"
author: "Barbara Flores"
format:
  pdf:
    toc: true
    number-sections: true
    number-depth: 3
output: 
  pdf_document: 
    latex_engine: xelatex
    keep_tex: true
    latex_args: ["-shell-escape"]
fontsize: 11pt
header-includes:
  - "\\usepackage[left=0.75in,right=0.75in,top=0.75in,bottom=1.25in]{geometry}"
  - "\\usepackage{enumitem}"
  - "\\setlist{noitemsep, topsep=0pt, parsep=2pt, partopsep=0pt}"
  - "\\setlength{\\parskip}{0pt}"
  - "\\RedeclareSectionCommand[beforeskip=-1sp,afterskip=0.5\\baselineskip]{section}"
  - "\\RedeclareSectionCommand[beforeskip=-1sp,afterskip=0.25\\baselineskip]{subsection}"

editor: 
  markdown: 
    wrap: 72
---

\setcounter{page}{0}

\thispagestyle{empty}

{{< pagebreak >}}

```{r, include = FALSE}
# Global settings to hide code and results in the final document
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, results= 'hide')
```

```{r}
library(pacman)
p_load(openintro, tidyverse,dplyr,tidyr, caret, pROC, e1071, sjPlot)
```

```{r}
 data("reddit_finance")
```

```{r}
# Cleaning data and selecting relevant columns for predictive modeling
# First, We created the reddit_finance dataset for easier work. 
reddit_finance_sub <- reddit_finance 

# Then, we create new variables that allow us to use the current variables in our model.

# We will make some assumptions and decision rules based on criteria to clean our dataset, which we will detail in the following code:

# 1. num_incomes: 
# How many individuals contribute to your household income?
# We have 1 record with NA, which we will replace with 0, and 2 records with n > 3, which we will replace with 4.


reddit_finance_sub$num_incomes <- ifelse(is.na(reddit_finance_sub$num_incomes), 0, reddit_finance_sub$num_incomes)

reddit_finance_sub$num_incomes <- ifelse(reddit_finance_sub$num_incomes == ">3", 4, reddit_finance_sub$num_incomes)


reddit_finance_sub$num_incomes <- as.numeric(reddit_finance_sub$num_incomes)

# 2. pan_inc_chg
# As a result of the pandemic, did your earned income increase, decrease, or remain the same?

reddit_finance_sub$pan_inc_chg <- factor(reddit_finance_sub$pan_inc_chg, levels = c( "Decreased","Stayed the same","Increased"))

# 3. pan_inc_chg_pct
# By how much did your earned income change?
# For this variable, we apply the decision rule of replacing the intervals with their order number. For example, the interval 1-10% will be replaced by 1, 11-20% by 2, and so on.

reddit_finance_sub <- reddit_finance_sub %>%
  mutate(pan_inc_chg_pct = case_when(
    pan_inc_chg_pct == "1-10%"  ~ 1,
    pan_inc_chg_pct == "11-20%" ~ 2,
    pan_inc_chg_pct == "21-30%" ~ 3,
    pan_inc_chg_pct == "31-40%" ~ 4,
    pan_inc_chg_pct == "41-50%" ~ 5,
    pan_inc_chg_pct == "51-60%" ~ 6,
    pan_inc_chg_pct == "61-70%" ~ 7,
    pan_inc_chg_pct == "71-80%" ~ 8,
    pan_inc_chg_pct == "81-90%" ~ 9,
    pan_inc_chg_pct == "91-100%" ~ 10,
    pan_inc_chg_pct == "No change" ~ 0,
    TRUE ~ as.numeric(pan_inc_chg_pct)  
  ))


reddit_finance_sub$pan_inc_chg_pct <- as.numeric(reddit_finance_sub$pan_inc_chg_pct)

# 4.pan_exp_chg
# As a result of the pandemic, did your expenses increase, decrease, or remain the same?

reddit_finance_sub$pan_exp_chg <- factor(reddit_finance_sub$pan_exp_chg, levels = c( "Decreased","Stayed the same", "Increased"))

# 5.pan_exp_chg_pct
# By how much did your expenses change?
# For this variable, we apply the decision rule of replacing the intervals with their order number. For example, the interval 1-10% will be replaced by 1, 11-20% by 2, and so on.

reddit_finance_sub <- reddit_finance_sub %>%
  mutate(pan_exp_chg_pct = case_when(
    pan_exp_chg_pct == "1-10%"  ~ 1,
    pan_exp_chg_pct == "11-20%" ~ 2,
    pan_exp_chg_pct == "21-30%" ~ 3,
    pan_exp_chg_pct == "31-40%" ~ 4,
    pan_exp_chg_pct == "41-50%" ~ 5,
    pan_exp_chg_pct == "51-60%" ~ 6,
    pan_exp_chg_pct == "61-70%" ~ 7,
    pan_exp_chg_pct == "71-80%" ~ 8,
    pan_exp_chg_pct == "81-90%" ~ 9,
    pan_exp_chg_pct == "91-100%" ~ 10,
    pan_exp_chg_pct == "No change" ~ 0,
    TRUE ~ as.numeric(pan_exp_chg_pct)  
  ))


reddit_finance_sub$pan_exp_chg_pct <- as.numeric(reddit_finance_sub$pan_exp_chg_pct)

# 6. pan_fi_chg
# As a result of the pandemic, did your FI (financially independent) number...

reddit_finance_sub$pan_fi_chg <- factor(reddit_finance_sub$pan_fi_chg, levels = c( "Decrease","No change", "Increase"))

# 7.pan_ret_date_chg
# As a result of the pandemic, did your planned RE (retirement) date...

reddit_finance_sub$pan_ret_date_chg <- factor(reddit_finance_sub$pan_ret_date_chg, levels = c( "Become later", "No change", "Become sooner"))

# 8. pan_financial_impact
#Overall, how would you characterize the pandemic's impact on your finances?

reddit_finance_sub$pan_financial_impact <- factor(reddit_finance_sub$pan_financial_impact, levels = c( "Negative", "Neutral", "Positive"))

# 9. political
# With which political party do you most closely identify? You do not need to be registered with a party to select it, answer based on your personal views.


reddit_finance_sub <- reddit_finance_sub %>%
  mutate(political_grouped = case_when(
    political %in% c("Democrat", "Libertarian Party", "Republican") ~ as.character(political),
    TRUE ~ "Other"
  ))

reddit_finance_sub$political_grouped <- as.factor(reddit_finance_sub$political_grouped)

# 10. race_eth
# What is your race/ethnicity? Select all that apply.

reddit_finance_sub <- reddit_finance_sub %>%
  mutate(race_eth_grouped = case_when(
    race_eth %in% c("N/A", "NA", "Decline to state") ~ NA_character_,
    TRUE ~ as.character(race_eth)
  ))

reddit_finance_sub$race_eth_grouped <- as.factor(reddit_finance_sub$race_eth_grouped)

# 11. gender
# What is your gender?


reddit_finance_sub <- reddit_finance_sub %>%
  mutate(gender_grouped = case_when(
    tolower(gender) %in% c("decline to state", "n/a", "na") ~ NA_character_,
    tolower(gender) %in% c("non-binary") ~ "Non-Binary",
    TRUE ~ as.character(gender)
  ))

reddit_finance_sub$gender_grouped <- as.factor(reddit_finance_sub$gender_grouped)


# 12 age
# What is your age?
# For this variable, we apply the decision rule of replacing the intervals with their order number. For example, the interval "<18" will be replaced by 1, "18-23" by 2, and so on.
reddit_finance_sub <- reddit_finance_sub %>%
  mutate(age = case_when(
    age %in% c("N/A", "NA") ~ NA_real_,
    age == "<18"   ~ 1,
    age == "18-23" ~ 2,
    age == "24-28" ~ 3,
    age == "29-33" ~ 4,
    age == "34-38" ~ 5,
    age == "39-43" ~ 6,
    age == "44-48" ~ 7,
    age == "49-53" ~ 8,
    age == "54-58" ~ 9,
    age == "59-63" ~ 10,
    TRUE ~ as.numeric(age)
  ))


reddit_finance_sub$age <- as.numeric(reddit_finance_sub$age)

# 13. edu
# What is the highest level of education you have completed?
#"For the case of the education variable, we grouped its values into broader categories."


reddit_finance_sub <- reddit_finance_sub %>%
  mutate(edu_grouped = case_when(
    edu %in% c("High School diploma / GED", "Less than high school", "Some high school") ~ "High School or Less",
    edu %in% c("Some college, no degree", "Trade School Degree") ~ "Some College or Trade School",
    edu %in% c("Associate's Degree", "Bachelor's Degree") ~ "Bachelor's or Associate's Degree",
    edu %in% c("Doctorate / Post Graduate", "Doctorate / Post-Graduate", "Graduate degree") ~ "Doctorate or Master's Degree",
    edu %in% c("N/A", "NA") ~ NA_character_,
    TRUE ~ as.character(edu)
  ))


edu_levels <- c("High School or Less", "Some College or Trade School", "Bachelor's or Associate's Degree",   "Doctorate or Master's Degree")
reddit_finance_sub$edu_grouped <- factor(reddit_finance_sub$edu_grouped, levels = edu_levels)


# 14. rel_status
# What is your relationship status?
 
reddit_finance_sub <- reddit_finance_sub %>%
  mutate(rel_status_grouped = case_when(
    rel_status %in% c("Divorced", "Widowed", "Single, never married") ~ "Singles",
    rel_status %in% c("Divorced - Remarried", "In a relationship, but not married", "Married", "Widowed - Remarried") ~ "In a Relationship",
    rel_status %in% c("N/A", "NA") ~ NA_character_,
    TRUE ~ as.character(rel_status)
  )) %>%
  mutate(rel_status_grouped = as.factor(rel_status_grouped))

# 15. children
# Do you have children?


reddit_finance_sub <- reddit_finance_sub %>%
  mutate(children_grouped = case_when(
    children %in% c("Do not have children, and do not intend to", "Do not have children, but intend to") ~ "No Children",
    children %in% c("Have children") ~ "Have Children",
    children %in% c("N/A", "NA") ~ NA_character_,
    TRUE ~ as.character(children)
  )) %>%
  mutate(children_grouped = as.factor(children_grouped))

# 16. country
# What country are you in?

reddit_finance_sub <- reddit_finance_sub %>%
  mutate(country_grouped = case_when(
    country %in% c("United States") ~ "United States",
    TRUE ~ "Other"
  )) %>%
  mutate(country_grouped = as.factor(country_grouped))

# 17. fin_indy
# Are you financially independent? Meaning you do not need to work for money, regardless of whether you work for money.


reddit_finance_sub$fin_indy <- ifelse(reddit_finance_sub$fin_indy == "Yes", 1, 0)

# 18. fin_indy_num
# At what amount invested will you consider yourself Financially Independent? (What is your FI number?)
reddit_finance_sub$fin_indy_num <- as.numeric(reddit_finance_sub$fin_indy_num)

# 19. fin_indy_pct
# What percent FI are you? (What percent of your FI number do you currently have?)
# While exploring this dataset, there are certain outlier values that appear to be errors, such as individuals who have 95000, 2.00E+05, 260000, 4800000 percent of their FI number. Therefore, we will replace these values with NA to avoid distorting our distribution of this variable

reddit_finance_sub <- reddit_finance_sub %>%
  mutate(
    fin_indy_pct = as.numeric(fin_indy_pct),  
    fin_indy_pct = ifelse(fin_indy_pct > 1000, NA_real_, fin_indy_pct)  
  )


# 25 fin_indy_lvl
# Which of the following would you have considered yourself at the time you reached Financial Independence:

reddit_finance_sub <- reddit_finance_sub %>%
  mutate(
    fin_indy_lvl = case_when(
      fin_indy_lvl == "Don't understand" ~ NA_character_,
      TRUE ~ fin_indy_lvl
    ),
    fin_indy_lvl = as.factor(fin_indy_lvl)
  )

# 26. retire_age
# At what age do you intend to retire?
# For this variable, we apply the decision rule of replacing the intervals with their order number. For example, the interval "24-28" will be replaced by 1, "29-33" by 2, and so on.
reddit_finance_sub <- reddit_finance_sub %>%
  mutate(retire_age = case_when(
    retire_age %in% c("Undecided") ~ NA_real_,
    retire_age == "24-28" ~ 1,
    retire_age == "29-33" ~ 2,
    retire_age == "34-38" ~ 3,
    retire_age == "39-43" ~ 4,
    retire_age == "44-48" ~ 5,
    retire_age == "49-53" ~ 6,
    retire_age == "54-58" ~ 7,
    retire_age == "59-63" ~ 8,
    retire_age == "64-68" ~ 9,
    retire_age == "69+"   ~ 10,
    TRUE ~ as.numeric(retire_age)
  ))


# 27. stp_whn_fin_indy
# Do you intend to stop working for money when you reach financial independence?

reddit_finance_sub$stp_whn_fin_indy <- as.factor(reddit_finance_sub$stp_whn_fin_indy)


# 28. industry
# Which of the following best describes the industry in which you currently or most recently work(ed)?
# After analyzing the distribution of industries in our dataset, we will group industries with lower frequency into 'Other Services'

reddit_finance_sub$industry_grouped <- as.factor(ifelse(
  reddit_finance_sub$industry %in% c(
    "Other Services", "Military", "Transportation",
    "Natural Resources", "Arts, Entertainment, Recreation",
    "Utilities", "Trade, transportation, utilities",
    "Agriculture, Forestry, Fishing", "Media", "Real Estate",
    "Leisure & Hospitality", "NA"
  ),
  "Other Services",
  reddit_finance_sub$industry
))


# 29. employer
# Which of the following best describes your current or most recent employer?
reddit_finance_sub$employer <- as.factor(reddit_finance_sub$employer)

# 30 role
# Which of the following best describes your current or most recent job role?
reddit_finance_sub$role <- as.factor(reddit_finance_sub$role)

# 31 ft_status
# What is your current employment status? - Full Time

reddit_finance_sub$ft_status <- ifelse(
  reddit_finance_sub$ft_status %in% c("N/A", "NA", "For an Organization (Employed), For Myself (Self-Employed)"),
  NA_character_,
  reddit_finance_sub$ft_status
)

reddit_finance_sub$ft_status <- as.factor(reddit_finance_sub$ft_status)


# 32. pt_status
# What is your current employment status? - Part Time, Regular

reddit_finance_sub$pt_status <- ifelse(
  reddit_finance_sub$pt_status %in% c("N/A", "NA", "For an Organization (Employed), For Myself (Self-Employed)"),
  NA_character_,
  reddit_finance_sub$pt_status
)

reddit_finance_sub$pt_status <- as.factor(reddit_finance_sub$pt_status)

# 33 gig_status
# What is your current employment status? -Side Gig, Intermittent

reddit_finance_sub$gig_status <- ifelse(
  reddit_finance_sub$gig_status %in% c("N/A", "NA", "For an Organization (Employed), For Myself (Self-Employed)"),
  NA_character_,
  ifelse(reddit_finance_sub$gig_status %in% c("For Myself (Self-Employed), N/A"), "For Myself (Self-Employed)", reddit_finance_sub$gig_status)
)

reddit_finance_sub$gig_status <- as.factor(reddit_finance_sub$gig_status)

# 34. ne_status
# What is your current employment status? -Not Employed

#It is decided to eliminate the variable 'ne_status' as it does not seem to make much sense. The question initially refers to people without employment, but later, in the responses, the type of employer is mentioned. Given this situation, it would be difficult to interpret.

# 35 edu_status
# What is your current educational status?

reddit_finance_sub$edu_status <- ifelse(reddit_finance_sub$edu_status %in% c("Full time student", "Part time student"), "Student", "Not a student")

reddit_finance_sub$edu_status <- as.factor(reddit_finance_sub$edu_status)


# 36 housing
# What is your current housing situation?


reddit_finance_sub <- reddit_finance_sub %>%
  mutate(housing_grouped = case_when(
    housing %in% c("Own",
                   "Own a house but currently living in a RV",
                   "Own a house that I rent out but I rent an apartment in another state",
                   "Rent and own",
                   "Rent my apartment, but own a home I rent out",
                   "Rent temporarily while building new home") ~ "Own",
    housing %in% c("Government housing",
                   "Homeless",
                   "House owned by parents",
                   "Houseless/nomadic - living in a car voluntarily",
                   "Live with family or friends",
                   "Live with family while building a house",
                   "Live with partner and split costs of owning",
                   "Live with partner in their house",
                   "Liveaboard boat",
                   "Living with parents",
                   "NA",
                   "Own and live in a van",
                   "Provided by employer or school",
                   "Rent") ~ "Not Own",
    TRUE ~ "Other"
  ))

reddit_finance_sub$housing_grouped <- as.factor(reddit_finance_sub$housing_grouped)

# 24, 37 - 65 
# For the income and expense variables, we will assume that missing values (NAs) indicate when a person has no expenses in that category. In such cases, we will consider these missing values to have a value of 0.

variables_to_replace <- c(
  "whn_fin_indy_num",
  "home_value",
  "brokerage_accts_tax",
  "retirement_accts_tax",
  "cash",
  "invst_accts",
  "spec_crypto",
  "invst_prop_bus_own",
  "other_val",
  "student_loans",
  "mortgage",
  "auto_loan",
  "credit_personal_loan",
  "medical_debt",
  "invst_prop_bus_own_debt",
  "other_debt",
  "2020_gross_inc",
  "2020_housing_exp",
  "2020_utilities_exp",
  "2020_transp_exp",
  "2020_necessities_exp",
  "2020_lux_exp",
  "2020_child_exp",
  "2020_debt_repay",
  "2020_invst_save",
  "2020_charity",
  "2020_healthcare_exp",
  "2020_taxes",
  "2020_edu_exp",
  "2020_other_exp"
)

# Replace NAs with 0 in the specified variables
reddit_finance_sub <- reddit_finance_sub %>%
  dplyr::mutate_at(vars(variables_to_replace), list(~replace_na(., 0)))


# Deleting outliers
#reddit_finance_sub <- reddit_finance_sub %>%
 # filter(abs(cash - mean(cash, na.rm = TRUE)) <= 3 * sd(cash, na.rm = TRUE))

#"Since there are many variables related to income or assets, debts, and expenses, we will create 3 variables that sum these individual items: total_debts, total_assets, and total_expenses

#total_assets
reddit_finance_sub <- reddit_finance_sub %>%
  mutate(total_assets = rowSums(select(., 
    c("home_value","brokerage_accts_tax","retirement_accts_tax","cash","invst_accts","spec_crypto","invst_prop_bus_own","other_val"))))


#total_debts
reddit_finance_sub <- reddit_finance_sub %>%
  mutate(total_debts = rowSums(select(., 
    c("student_loans","mortgage","auto_loan","credit_personal_loan","medical_debt","invst_prop_bus_own_debt","other_debt"))))

#total_expenses
reddit_finance_sub <- reddit_finance_sub %>%
  mutate(total_expenses = rowSums(select(., 
    c("2020_housing_exp", "2020_utilities_exp", "2020_transp_exp", "2020_necessities_exp", "2020_lux_exp", "2020_child_exp","2020_debt_repay", "2020_charity", "2020_healthcare_exp","2020_taxes", "2020_edu_exp", "2020_other_exp"))))

# We finally removed some previously transformed variables that we will not be using in their original form.
reddit_finance_sub <- reddit_finance_sub[, !(names(reddit_finance_sub) %in% c("political", "race_eth", "gender", "edu", "rel_status", "children","country", "industry","ne_status","housing","home_value","brokerage_accts_tax","retirement_accts_tax", "cash", "invst_accts","spec_crypto","invst_prop_bus_own","other_val","student_loans","mortgage","auto_loan","credit_personal_loan","medical_debt","invst_prop_bus_own_debt","other_debt","2020_housing_exp","2020_utilities_exp","2020_transp_exp","2020_necessities_exp","2020_lux_exp","2020_child_exp","2020_debt_repay","2020_charity","2020_healthcare_exp","2020_taxes","2020_edu_exp","2020_other_exp"))]
```

```{r}
#We are removing the NA records from the variables that we will use for our model.
columns <- c("age", "political_grouped", "edu_grouped", "housing_grouped", "total_debts", 
                      "total_assets", "total_expenses", "2020_gross_inc", "2020_invst_save")

reddit_finance_sub <- reddit_finance_sub[complete.cases(reddit_finance_sub[, columns]), ]

```

\vspace{0.5cm}

# **Overview**

The objective of this project is to address the research question:

**What factors contribute to an individual's perception of financial
independence?**

To accomplish this objective, we will perform logistic regression
analysis using a dataset that is a subset of the official results from
the 2020 Financial Independence Survey on Reddit. This subset includes
responses from individuals who represent themselves (excluding
contributions from other household members) and excludes responses from
retired individuals. The dataset encompasses **1,998 rows** and **65
variables**, covering information such as income contributors, the
financial impact of the pandemic, political affiliation, demographics,
details about financial independence, employment status, and various
financial aspects. The data has been sourced from Reddit. For additional
details regarding the data dictionary and source information, please
refer to the
[www.openintro.org](https://www.openintro.org/data/index.php?data=reddit_finance)
website.

In our original dataset, 147 individuals, which accounts for 8% of our
sample, reported considering themselves financially independent.
Therefore, we have unbalanced data, which we should take into
consideration in our future analyses.

\vspace{0.5cm}

# **Data cleaning**

In the data cleaning process, the following transformations were
implemented. For more details on the specific variables that experienced
these transformations, please refer to the appendix 6.1.

-   The dependent variable **fin_indy** (Are you financially
    independent?) was transformed from a string variable to a binary
    numeric variable (0 and 1).

-   The variable **political** had 24 categories, which were reduced to
    4: 'Democrat,' 'Libertarian Party,' 'Republican,' and 'Other,'
    because the data had many categories with very few observations.
    Finally, it was transformed from string to factor.

-   The variable **age** was transformed from a string variable to a
    numeric variable to simplify analysis, with each category assigned a
    corresponding numeric value (1-8) to represent age brackets.

-   The variable **edu** had 11 categories, which were reduced to 4:
    "High School or Less", "Some College or Trade School", "Bachelor's
    or Associate's Degree", "Doctorate or Master's Degree", because the
    data had many categories with very few observations. Then, it was
    transformed from string to factor.

-   The variable **housing** (What is your current housing situation?)
    had 19 categories, which were reduced to 2: "Own", "Not Own",
    because the data had many categories with very few observations.
    Finally, it was transformed from string to factor.

-   Out of a total of 29 variables, which constituted numeric-type
    variables such as Children Expenses, Luxury Expenses, Transportation
    Expenses, Taxes, Medical Debt, etc., it was observed that they did
    not contain the number 0 but did have many NA values. The assumption
    was made that individuals who responded with NA in fields such as
    Children Expenses did so because they had no associated expenses in
    that category. For this reason, in these 29 variables, NA values
    were replaced with 0. The complete detail of the variables can be
    reviewed on the appendix page.

-   The variable **total_assets** was created, which is formed by the
    sum of 8 variables such as cash, investment accounts, crypto, etc.
    For more details, refer to the appendix.

-   The variable **total_debts** was created, which is formed by the sum
    of 7 variables such as student loans, mortgage, medical debt, etc.
    For more details, refer to the appendix.

-   The variable **total_expenses** was created, which is formed by the
    sum of 12 variables such as necessities expenses, children expenses,
    transportation expenses, etc.

-   Finally, observations with NA values for any of the above variables
    were removed, resulting in 11 observations out of the original total
    of 1,998, leaving us with 1,987 final observations.

# **Modeling**

\vspace{0.5cm}

## Logistic Regression Model

To address our research question, we will employ a Logistic Regression
Model. This model is suitable for this situation as it allows us to
examine how various predictor variables influence the probability of an
individual perceiving financial independence. Given that the variable of
interest is binary (yes/no), logistic regression will provide us with
estimations of log probabilities and coefficients that will aid in
understanding the direction and strength of the relationship between the
considered factors and the perception of financial independence.

\vspace{0.5cm}

## Variable Selection

After analyzing the variables provided in the dataset, those that could
be considered to influence the financial independence variable were
identified. The following variables were selected a priori as
predictors: **Age**, **Political** (With which political party do you
most closely identify? ), **Education** (What is the highest level of
education you have completed? ), **Housing** (What is your current
housing situation? **Rent**, Own...) , **Total Debts**, **Total
Assets**, **Total Expenses**, **2020 Gross Income**, **2020 Investments,
2020 savings**.

For the variable age, it is expected that as a person gets older, they
are more likely to have achieved greater economic stability and,
therefore, are more inclined to being financially independent. Regarding
the political variable, it is anticipated that individuals belonging to
parties that oppose, for example, tax increases, see economic
independence as feasible through their own assets. It is expected that
with higher education, there is a greater likelihood of being
financially independent. Concerning the housing variable, it is expected
that owning a home will significantly impact the dependent variable. In
the case of the variables debt, assets, expenses, 2020 income, and 2020
investments, they are considered closely related to the dependent
variable, as the available wealth of an individual, i.e., income minus
expenses, assets minus liabilities, will determine whether they can
achieve economic independence or not.

\vspace{0.5cm}

# **Results**

```{r, results = FALSE}
logistic_mod <- glm(factor(fin_indy) ~ 
                     age+
                    political_grouped
                  + edu_grouped
                  + housing_grouped
                  + total_debts
                  + total_assets
                  + total_expenses
                  + `2020_gross_inc`
                  + `2020_invst_save`
                  ,data=reddit_finance_sub,
                  family="binomial")

summary(logistic_mod)
```

```{r}
rows_to_remove <-  c(168, 156, 167, 165)
reddit_finance_sub2 <- reddit_finance_sub[-rows_to_remove, ]

```

## Model results

An initial Model 1 was constructed using the specified variables, but it
was observed that some of these variables lacked significance. Model 1
had an AIC of 925 (you can refer to the details of Model 1 in Appendix
6.2). Following this, influential data points were identified through
Cook's distance analysis and subsequently removed from the dataset. This
process led to the development of Model 2, the results of which are
presented below. The Cook's distance plots for both models can be found
in Appendix 6.3.

```{r, results = TRUE}
logistic_mod2 <- glm(factor(fin_indy) ~ 
                    age
                  + political_grouped
                  + edu_grouped
                  + housing_grouped
                  + total_debts
                  + total_assets
                  + total_expenses
                  + `2020_gross_inc`
                  + `2020_invst_save`
                  ,data=reddit_finance_sub2,
                  family="binomial")

summary(logistic_mod2)
```

Model 2 exhibits a significantly improved AIC of 824.55 compared to the
previous Model 1 (925), indicating a better model fit and greater
explanatory power. The results suggest that age, political affiliation
(specifically, affiliation with the Republican party), total debts,
total assets, total expenses, 2020 gross income, and 2020 savings and
investments are factors that influence the likelihood of perceiving
financial independence. However, education and housing situation did not
show significant associations in this model. The coefficients in the
logistic regression model represent the log odds. For example, in our
model, an increase in the age bracket by 1 unit results in a log odds
increase of 0.4441. This means that for each step up in age bracket, the
odds of perceiving financial independence increase by a factor of
exp(0.4441), which can be interpreted as a percentage change in the
odds.

## ROC Curve

```{r, fig.width=8, fig.height=4.3, results = TRUE}

roc1 <- roc(reddit_finance_sub$fin_indy, fitted(logistic_mod))
roc2 <- roc(reddit_finance_sub2$fin_indy, fitted(logistic_mod2))


# Create the ROC plot
plot(roc1, col = "blue", main = "ROC Curve Comparison")  # First ROC curve
lines(roc2, col = "red")  # Second ROC curve

# Add a legend
legend("bottomright", legend = c("Model 1", "Model 2"), col = c("blue", "red"), lwd = 2)

# Print the AUC values for both models
text(0.6, 0.3, paste("AUC Model 1 = ", round(roc1$auc, 4)), col = "blue")
text(0.6, 0.25, paste("AUC Model 2 = ", round(roc2$auc, 4)), col = "red")

# Print the best threshold for Model 2 with more decimals
best_threshold_model2 <- roc2$thresholds[which.max(roc2$sensitivities + roc2$specificities)]
text(0.6, 0.2, sprintf("Best Threshold Model 2 = %.4f", best_threshold_model2), col = "red")


```

To assess the logistic regression of the model, ROC curves were plotted
for both Model 1 and Model 2. It is observed that the AUC of Model 1 is
0.764, while the AUC of Model 2 is 0.8594. This indicates that Model 2
exhibits superior performance in terms of its ability to distinguish
between the categories of the variable of interest (in this case, the
perception of financial independence).

In this plot, we can observe that our "Best Threshold Model 2" is
0.0664. This value represents the optimal threshold for classification
in Model 2.

\vspace{0.5cm}

## Confusion Matrix

\vspace{0.5cm}

We used this threshold to create our confusion matrix (Appendix 6.4).
The main performance indicators are:

| Prediction | No   | Yes |
|------------|------|-----|
| No         | 1318 | 53  |
| Yes        | 524  | 93  |

Accuracy : 0.7098 Kappa : 0.1418 Sensitivity : 0.63699 Specificity :
0.71553

\vspace{0.5cm}

First, we look at **Accuracy** which measures the overall correctness of
our model's predictions. In this case, our model achieves an accuracy of
70.98%, indicating that it correctly predicts whether an event will
occur or not in nearly 71% of cases. Additionally, we consider the
**Kappa statistic**, which assesses the agreement between our model's
predictions and random chance. A Kappa value of 0.1418 suggests a slight
agreement beyond what would be expected by chance. Practical
applicability is revealed by a **Sensitivity** of 63.7%, meaning it
correctly identifies 63.7% of positive cases, and a **Specificity** of
71.553%, correctly identifying 71.6% of negatives. These indicators
collectively provide insights into the model's performance and its
ability to make accurate predictions.

## Results figure

After generating our model, we can, observe the behavior of one of the
variables that turned out to be most influential in predicting our
dependent variable, Total Assets. We can see how the group of
individuals who are financially independent indeed has significantly
higher assets.

```{r, fig.width=8, fig.height=5, results = TRUE}
reddit_finance_sub2$fin_indy <- ifelse(reddit_finance_sub2$fin_indy == 1, "Yes", "No")


reddit_finance_sub2$fin_indy <- as.factor(reddit_finance_sub2$fin_indy)

boxplot(total_assets ~ fin_indy, data = reddit_finance_sub2, 
        main = "Total Assets vs Financial independence perception",
        xlab = "Financial independence perception", ylab = "Total Assets",
        outline = FALSE)

reddit_finance_sub2$fin_indy <- ifelse(reddit_finance_sub2$fin_indy == "Yes", 1, 0)
reddit_finance_sub2$fin_indy <- as.numeric(reddit_finance_sub2$fin_indy)
```

# **Conclusion and Future work**

## Conclusion

The analysis looks to investigate the factors contributing to an
individual's perception of financial independence. The findings indicate
that various variables play a crucial role in shaping this perception.
Age was a significant factor, with older individuals more likely to
perceive themselves as financially independent. Political affiliation,
particularly with the Republican party, emerged as an influential
factor, suggesting that certain political ideologies may influence one's
financial perspective. Furthermore, total debts, total assets, total
expenses, 2020 gross income, and 2020 savings and investments were
identified as significant contributors to financial independence
perception. These variables reflect the complex interplay between
economic resources, expenses, and income.

\vspace{0.5cm}

## Future work

However, the analysis had limitations, including the removal of
influential data points to enhance model performance. This process might
have excluded valuable information. Moreover, variables such as
education and housing situation did not show significant associations in
this model, suggesting that other factors may be at play. To further
strengthen the analysis, future work should involve refining data
collection, expanding the dataset and implementing **cross-validation**.
These steps will contribute to addressing limitations and enhancing the
analysis's robustness and accuracy.

{{< pagebreak >}}

# Appendix

## Variable Transformation

+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| **Variable**   | **Transformation**                      |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| political      | -   From 24 original categories, it was |
|                |     grouped into 4:\                    |
|                |     "Democrat"\                         |
|                |     "Libertarian Party"\                |
|                |     "Republican"\                       |
|                |     "Other" --\> ("American Solidarity  |
|                |     Party","Citizens Party of the       |
|                |     United States","Communist Party     |
|                |     USA","Constitution Party","Freedom  |
|                |     Socialist Party","Green             |
|                |     Party","Humane Party","Independent  |
|                |     American Party","Legal Marijuana    |
|                |     Now Party","N/A","NA","National     |
|                |     Socialist                           |
|                |     Movement","None","Objectivist       |
|                |     Party","Peace and Freedom           |
|                |     Party","Socialist                   |
|                |     Action","Socialist                  |
|                |     Alternative","Socialist Equality    |
|                |     Party","Socialist Party             |
|                |     USA","United States Marijuana       |
|                |     Party","United States Pirate        |
|                |     Party","Workers World Party")       |
|                |                                         |
|                | -   Transformed into a factor.          |
+----------------+-----------------------------------------+
| age            | -   It was transformed from string to   |
|                |     numeric (1-10)                      |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| edu            | -   From 11 original categories, it was |
|                |     grouped into 4:\                    |
|                |     "High School or Less" --\> ("High   |
|                |     School diploma / GED", "Less than   |
|                |     high school", "Some high school")\  |
|                |     "Some College or Trade School" --\> |
|                |     ("Some college, no degree", "Trade  |
|                |     School Degree")\                    |
|                |     "Bachelor's or Associate's Degree"  |
|                |     --\> ("Associate's Degree",         |
|                |     "Bachelor's Degree")\               |
|                |     "Doctorate or Master's Degree" --\> |
|                |     ("Doctorate / Post Graduate",       |
|                |     "Doctorate / Post-Graduate",        |
|                |     "Graduate degree")                  |
|                | -   Transformed into a factor.          |
+----------------+-----------------------------------------+
| fin_indy       | -   It was transformed from string to   |
|                |     binary                              |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| housing        | -   From the original 19 categories, it |
|                |     was grouped into 2:\                |
|                |     "Own" --\> (Own", "Own a house but  |
|                |     currently living in a RV", "Own a   |
|                |     house that I rent out but I rent an |
|                |     apartment in another state", "Rent  |
|                |     and own", "Rent my apartment, but   |
|                |     own a home I rent out", "Rent       |
|                |     temporarily while building new      |
|                |     home")\                             |
|                |     "Not Own" --\> ("Government         |
|                |     housing", "Homeless", "House owned  |
|                |     by parents", "Houseless/nomadic -   |
|                |     living in a car voluntarily", "Live |
|                |     with family or friends", "Live with |
|                |     family while building a house",     |
|                |     "Live with partner and split costs  |
|                |     of owning", "Live with partner in   |
|                |     their house", "Liveaboard boat",    |
|                |     "Living with parents", "NA", "Own   |
|                |     and live in a van", "Provided by    |
|                |     employer or school", "Rent")        |
|                |                                         |
|                | -   Transformed into a factor.          |
+----------------+-----------------------------------------+
| home_value     | -   NA replaced with 0                  |
|                | -   sum in total_assets variable        |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| broke          | -   NA replaced with 0                  |
| rage_accts_tax |                                         |
|                | -   sum in total_assets variable        |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| retire         | -   NA replaced with 0                  |
| ment_accts_tax |                                         |
|                | -   sum in total_assets variable        |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| cash           | -   NA replaced with 0                  |
|                |                                         |
|                | -   sum in total_assets variable        |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| invst_accts    | -   NA replaced with 0                  |
|                |                                         |
|                | -   sum in total_assets variable        |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| spec_crypto    | -   NA replaced with 0                  |
|                |                                         |
|                | -   sum in total_assets variable        |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| invs           | -   NA replaced with 0                  |
| t_prop_bus_own |                                         |
|                | -   sum in total_assets variable        |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| other_val      | -   NA replaced with 0                  |
|                |                                         |
|                | -   sum in total_assets variable        |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| student_loans  | -   NA replaced with 0                  |
|                |                                         |
|                | -   sum in total_debts variable         |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| mortgage       | -   NA replaced with 0                  |
|                |                                         |
|                | -   sum in total_debts variable         |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| auto_loan      | -   NA replaced with 0                  |
|                |                                         |
|                | -   sum in total_debts variable         |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| credi t\       | -   NA replaced with 0                  |
| \              |                                         |
| \              | -   sum in total_debts variable         |
| \              |                                         |
| _personal_loan |                                         |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| medical_debt   | -   NA replaced with 0                  |
|                |                                         |
|                | -   sum in total_debts variable         |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| invst_pr o     | -   NA replaced with 0                  |
| p_bus_own_debt |                                         |
|                | -   sum in total_debts variable         |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| other_debt     | -   NA replaced with 0                  |
|                |                                         |
|                | -   sum in total_debts variable         |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| 2020_gross_inc | -   NA replaced with 0                  |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| 2 0            | -   NA replaced with 0                  |
| 20_housing_exp |                                         |
|                | -   sum in total_expenses variable      |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| 202 0\         | -   NA replaced with 0                  |
| \              |                                         |
| \              | -   sum in total_expenses variable      |
| \              |                                         |
| _utilities_exp |                                         |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| 2              | -   NA replaced with 0                  |
| 020_transp_exp |                                         |
|                | -   sum in total_expenses variable      |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| 2020_n         | -   NA replaced with 0                  |
| ecessities_exp |                                         |
|                | -   sum in total_expenses variable      |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| 2020_lux_exp   | -   NA replaced with 0                  |
|                |                                         |
|                | -   sum in total_expenses variable      |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| 2020_child_exp | -   NA replaced with 0                  |
|                |                                         |
|                | -   sum in total_expenses variable      |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| 2              | -   NA replaced with 0                  |
| 020_debt_repay |                                         |
|                | -   sum in total_expenses variable      |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| 2              | -   NA replaced with 0                  |
| 020_invst_save |                                         |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| 2020_charity   | -   NA replaced with 0                  |
|                |                                         |
|                | -   sum in total_expenses variable      |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| 2020\_         | -   NA replaced with 0                  |
| healthcare_exp |                                         |
|                | -   sum in total_expenses variable      |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| 2020_taxes     | -   NA replaced with 0                  |
|                |                                         |
|                | -   sum in total_expenses variable      |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| 2020_edu_exp   | -   NA replaced with 0                  |
|                |                                         |
|                | -   sum in total_expenses variable      |
+----------------+-----------------------------------------+
| \vspace{0.3cm} | \vspace{0.3cm}                          |
|                |                                         |
| 2020_other_exp | -   NA replaced with 0                  |
|                |                                         |
|                | -   sum in total_expenses variable      |
+----------------+-----------------------------------------+

{{< pagebreak >}}

## Results model 1

```{r, results = TRUE}
summary(logistic_mod)
```

## Cook's distance

### Model 1

```{r, results = TRUE}
plot(logistic_mod, which =4)
```

\vspace{0.5cm}

### Model 2

```{r, results = TRUE}
plot(logistic_mod2, which =4)
```

{{< pagebreak >}}

## Confusion Matrix

### Model 2

```{r, results = TRUE}
reddit_finance_sub <- reddit_finance_sub %>%
 mutate(fin_indy = ifelse(fin_indy == 1, "Yes", "No"))

confusionMatrix(factor(ifelse(fitted(logistic_mod)>0.0664,"Yes","No")),factor(reddit_finance_sub$fin_indy),positive="Yes",mode="everything")

```
