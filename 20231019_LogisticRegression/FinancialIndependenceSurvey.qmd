---
format: pdf 
output: 
  pdf_document: 
  latex_engine: xelatex
---

```{r, include = FALSE}
# Global settings to hide code and results in the final document
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, results='hide')
```

```{r}
library(pacman)
p_load(openintro, tidyverse,dplyr)

```

```{r}
 data("reddit_finance")
```

```{r}
# Cleaning data and selecting relevant columns for predictive modeling
#First, We created the reddit_finance dataset for easier work. 
reddit_finance_sub <- reddit_finance 

#Then, we create new variables that allow us to use the current variables in our model.

#We will make some assumptions and decision rules based on criteria to clean our dataset, which we will detail in the following code:

# 1. num_incomes: 
# How many individuals contribute to your household income?
# We have 1 record with NA, which we will replace with 0, and 2 records with n > 3, which we will replace with 4.


reddit_finance_sub$num_incomes <- ifelse(is.na(reddit_finance_sub$num_incomes), 0, reddit_finance_sub$num_incomes)

reddit_finance_sub$num_incomes <- ifelse(reddit_finance_sub$num_incomes == ">3", 4, reddit_finance_sub$num_incomes)


reddit_finance_sub$num_incomes <- as.numeric(reddit_finance_sub$num_incomes)

# 2. pan_inc_chg
# As a result of the pandemic, did your earned income increase, decrease, or remain the same?

reddit_finance_sub$pan_inc_chg <- factor(reddit_finance_sub$pan_inc_chg, levels = c( "Decreased","Stayed the same","Increased"))

# 3. pan_inc_chg_pct
# By how much did your earned income change?
# For this variable, we apply the decision rule of replacing the intervals with their central number. For example, the interval 1-10% will be replaced by 5%, 11-20% by 15%, and so on.

reddit_finance_sub <- reddit_finance_sub %>%
  mutate(pan_inc_chg_pct = case_when(
    pan_inc_chg_pct == "1-10%"  ~ 0.05,
    pan_inc_chg_pct == "11-20%" ~ 0.15,
    pan_inc_chg_pct == "21-30%" ~ 0.25,
    pan_inc_chg_pct == "31-40%" ~ 0.35,
    pan_inc_chg_pct == "41-50%" ~ 0.45,
    pan_inc_chg_pct == "51-60%" ~ 0.55,
    pan_inc_chg_pct == "61-70%" ~ 0.65,
    pan_inc_chg_pct == "71-80%" ~ 0.75,
    pan_inc_chg_pct == "81-90%" ~ 0.85,
    pan_inc_chg_pct == "91-100%" ~ 0.95,
    pan_inc_chg_pct == "No change" ~ 0,
    TRUE ~ as.numeric(pan_inc_chg_pct)  
  ))


reddit_finance_sub$pan_inc_chg_pct <- as.numeric(reddit_finance_sub$pan_inc_chg_pct)

# 4.pan_exp_chg
#As a result of the pandemic, did your expenses increase, decrease, or remain the same?

reddit_finance_sub$pan_exp_chg <- factor(reddit_finance_sub$pan_exp_chg, levels = c( "Decreased","Stayed the same", "Increased"))

# 5.pan_exp_chg_pct
#By how much did your expenses change?
# For this variable, we apply the decision rule of replacing the intervals with their central number. For example, the interval 1-10% will be replaced by 5%, 11-20% by 15%, and so on.

reddit_finance_sub <- reddit_finance_sub %>%
  mutate(pan_exp_chg_pct = case_when(
    pan_exp_chg_pct == "1-10%"  ~ 0.05,
    pan_exp_chg_pct == "11-20%" ~ 0.15,
    pan_exp_chg_pct == "21-30%" ~ 0.25,
    pan_exp_chg_pct == "31-40%" ~ 0.35,
    pan_exp_chg_pct == "41-50%" ~ 0.45,
    pan_exp_chg_pct == "51-60%" ~ 0.55,
    pan_exp_chg_pct == "61-70%" ~ 0.65,
    pan_exp_chg_pct == "71-80%" ~ 0.75,
    pan_exp_chg_pct == "81-90%" ~ 0.85,
    pan_exp_chg_pct == "91-100%" ~ 0.95,
    pan_exp_chg_pct == "No change" ~ 0,
    TRUE ~ as.numeric(pan_exp_chg_pct)  
  ))


reddit_finance_sub$pan_exp_chg_pct <- as.numeric(reddit_finance_sub$pan_exp_chg_pct)

# 6. pan_fi_chg
# As a result of the pandemic, did your FI (financially independent) number...

reddit_finance_sub$pan_fi_chg <- factor(reddit_finance_sub$pan_fi_chg, levels = c( "Decrease","No change", "Increase"))

# 7.pan_ret_date_chg
# As a result of the pandemic, did your planned RE (retirement) date...

reddit_finance_sub$pan_ret_date_chg <- factor(reddit_finance_sub$pan_ret_date_chg, levels = c( "Become later", "No change", "Become sooner"))

# 8. pan_financial_impact
#Overall, how would you characterize the pandemic's impact on your finances?

reddit_finance_sub$pan_financial_impact <- factor(reddit_finance_sub$pan_financial_impact, levels = c( "Negative", "Neutral", "Positive"))

#9. political
#With which political party do you most closely identify? You do not need to be registered with a party to select it, answer based on your personal views.


reddit_finance_sub <- reddit_finance_sub %>%
  mutate(political_grouped = case_when(
    political %in% c("Democrat", "Libertarian Party", "Republican") ~ as.character(political),
    TRUE ~ "Other"
  ))

reddit_finance_sub$political_grouped <- as.factor(reddit_finance_sub$political_grouped)

#10. race_eth
# What is your race/ethnicity? Select all that apply.

reddit_finance_sub <- reddit_finance_sub %>%
  mutate(race_eth_grouped = case_when(
    race_eth %in% c("N/A", "NA", "Decline to state") ~ NA_character_,
    TRUE ~ as.character(race_eth)
  ))

reddit_finance_sub$race_eth_grouped <- as.factor(reddit_finance_sub$race_eth_grouped)

# 11. gender
# What is your gender?


reddit_finance_sub <- reddit_finance_sub %>%
  mutate(gender_grouped = case_when(
    tolower(gender) %in% c("decline to state", "n/a", "na") ~ NA_character_,
    tolower(gender) %in% c("non-binary") ~ "Non-Binary",
    TRUE ~ as.character(gender)
  ))

reddit_finance_sub$gender_grouped <- as.factor(reddit_finance_sub$gender_grouped)


# 12 age
# What is your age?
# For this variable, we apply the decision rule of replacing the intervals with their central number. For example, the interval 18-23 will be replaced by 21, 24-28 by 26, and so on.
reddit_finance_sub <- reddit_finance_sub %>%
  mutate(age = case_when(
    age %in% c("<18", "N/A", "NA") ~ NA_real_,
    age == "18-23" ~ 21,
    age == "24-28" ~ 26,
    age == "29-33" ~ 31,
    age == "34-38" ~ 36,
    age == "39-43" ~ 41,
    age == "44-48" ~ 46,
    age == "49-53" ~ 51,
    age == "54-58" ~ 56,
    age == "59-63" ~ 61,
    TRUE ~ as.numeric(age)
  ))

reddit_finance_sub$age <- as.numeric(reddit_finance_sub$age)

#edu
#What is the highest level of education you have completed?
#"For the case of the education variable, we grouped its values into broader categories."


reddit_finance_sub <- reddit_finance_sub %>%
  mutate(edu_grouped = case_when(
    edu %in% c("High School diploma / GED", "Less than high school", "Some high school") ~ "High School or Less",
    edu %in% c("Some college, no degree", "Trade School Degree") ~ "Some College or Trade School",
    edu %in% c("Associate's Degree", "Bachelor's Degree") ~ "Bachelor's or Associate's Degree",
    edu %in% c("Doctorate / Post Graduate", "Doctorate / Post-Graduate", "Graduate degree") ~ "Doctorate or Master's Degree",
    edu %in% c("N/A", "NA") ~ NA_character_,
    TRUE ~ as.character(edu)
  ))


edu_levels <- c("High School or Less", "Some College or Trade School", "Bachelor's or Associate's Degree",   "Doctorate or Master's Degree")
reddit_finance_sub$edu_grouped <- factor(reddit_finance_sub$edu_grouped, levels = edu_levels)


#rel_status
#What is your relationship status?

reddit_finance_sub <- reddit_finance_sub %>%
  mutate(rel_status_grouped = case_when(
    rel_status %in% c("Divorced", "Divorced - Remarried") ~ "Divorced or Remarried",
    rel_status %in% c("In a relationship, but not married", "Married", "Widowed", "Widowed - Remarried") ~ "Married or In a Relationship",
    rel_status %in% c("Single, never married") ~ "Single, Never Married",
    rel_status %in% c("N/A", "NA") ~ NA_character_,
    TRUE ~ as.character(rel_status)
  )) %>%
  mutate(rel_status_grouped = as.factor(rel_status_grouped))





```

```{r}
count_table <- reddit_finance_sub %>%
  count(rel_status_grouped)

# Imprime la tabla de conteo
count_table
```

```{r}
summary(reddit_finance_sub)
```

```{r}
```

```{r}
glimpse(reddit_finance)
```

```{write.csv(reddit_finance, file = "mi_archivo.csv", row.names = FALSE)}

```

# Financial Independence Survey - Logistic Regression Model

## **Overview**

The objective of this project is to develop a Logistic Regression Model to address the Research Question: **What factors contribute to an individual's perception of financial independence?**

To accomplish this objective, we will analyze a dataset that is a subset of the official results from the 2020 Financial Independence Survey on Reddit (r/financialindependence). This subset exclusively comprises responses from individuals representing themselves (excluding contributions from other household members) and excludes retired individuals. The dataset encompasses **1,998 rows and 65 variables**, covering information such as income contributors, the financial impact of the pandemic, political affiliation, demographics, details about financial independence, employment status, and various financial aspects. The data has been sourced from Reddit.

For additional details regarding the data dictionary and source information, please refer to the [www.openintro.org](https://www.openintro.org/data/index.php?data=reddit_finance) website.

## **Data cleaning**

Which variables required cleaning? Are there any missing values? Did you make any assumptions during the data cleaning process?

## **Modeling**

## **Results**

## **Future work**
